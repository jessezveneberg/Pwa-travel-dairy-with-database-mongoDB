<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–©–æ–¥–µ–Ω–Ω–∏–∫ –ø–æ–¥–æ—Ä–æ–∂–µ–π</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://unpkg.com/idb@7/build/umd.js"></script>
  <style>
    /* –ö—Ä–∏—Ç–∏—á–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è –º–∏—Ç—Ç—î–≤–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: #2c3e50; }
    .app-container { max-width: 1000px; margin: 0 auto; padding: 20px; background: #f8f9fa; min-height: 100vh; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    h1 { color: #2E7D32; font-size: 2.2em; margin: 0; }
    .loading { text-align: center; padding: 40px; color: #666; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <h1>üåç –©–æ–¥–µ–Ω–Ω–∏–∫ –ø–æ–¥–æ—Ä–æ–∂–µ–π</h1>
      <button id="install-btn" class="hidden">üì≤ –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫</button>
    </header>

    <main>
      <section class="entry-form">
        <h2>‚ûï –ù–æ–≤–∏–π –∑–∞–ø–∏—Å</h2>
        <form id="entry-form">
          <div class="form-group">
            <label for="title">–ù–∞–∑–≤–∞:</label>
            <input type="text" id="title" required placeholder="–ù–∞–∑–≤–∞ –ø–æ–¥–æ—Ä–æ–∂—ñ">
          </div>
          
          <div class="form-group">
            <label for="description">–û–ø–∏—Å:</label>
            <textarea id="description" rows="3" placeholder="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—É –ø–æ–¥–æ—Ä–æ–∂..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="photo">–§–æ—Ç–æ:</label>
            <input type="file" id="photo" accept="image/*">
            <div id="photo-preview" class="photo-preview"></div>
          </div>
          
          <div class="form-group">
            <label for="location">–ú—ñ—Å—Ü–µ:</label>
            <input type="text" id="location" readonly placeholder="–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –º—ñ—Å—Ü—è">
            <button type="button" id="get-location">üìç –û—Ç—Ä–∏–º–∞—Ç–∏ –º–æ—î –º—ñ—Å—Ü–µ</button>
            <button type="button" id="manual-location" class="manual-location-btn hidden">
              üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –º—ñ—Å—Ü–µ
            </button>
          </div>
          
          <button type="submit">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–∞–ø–∏—Å</button>
        </form>
      </section>

      <section class="entries-list">
        <h2>üìñ –ú–æ—ó –ø–æ–¥–æ—Ä–æ–∂—ñ</h2>
        <div id="entries-container" class="entries-container">
          <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤...</p>
        </div>
        <button id="generate-pdf" class="generate-btn">üìÑ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ PDF –∑–≤—ñ—Ç</button>
        <button id="clear-data" class="clear-btn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –¥–∞–Ω—ñ</button>
        <button id="clear-cache" class="clear-btn">üîÑ –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à PWA</button>
      </section>
    </main>
  </div>

  <div id="toast" class="toast hidden"></div>

  <script src="/app.js"></script>
  
  <script>
    // –ü—Ä–∏–º—É—Å–æ–≤–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è Service Worker –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async function() {
        try {
          // –°–ø–æ—á–∞—Ç–∫—É –≤–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ —Å—Ç–∞—Ä—ñ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
          const registrations = await navigator.serviceWorker.getRegistrations();
          for (let registration of registrations) {
            await registration.unregister();
            console.log('–°—Ç–∞—Ä–∏–π Service Worker –≤–∏–¥–∞–ª–µ–Ω–æ');
          }
          
          // –û—á–∏—â–∞—î–º–æ –∫–µ—à
          if ('caches' in window) {
            const cacheNames = await caches.keys();
            for (let cacheName of cacheNames) {
              await caches.delete(cacheName);
              console.log('–ö–µ—à –≤–∏–¥–∞–ª–µ–Ω–æ:', cacheName);
            }
          }
          
          // –†–µ—î—Å—Ç—Ä—É—î–º–æ –Ω–æ–≤–∏–π Service Worker
          const registration = await navigator.serviceWorker.register('/service-worker.js?v=2');
          console.log('–ù–æ–≤–∏–π Service Worker –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ:', registration);
          
        } catch (error) {
          console.error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è Service Worker:', error);
        }
      });
    }
  </script>
</body>
</html>